---
import BaseLayout from "../layouts/BaseLayout.astro";
import ImageComp from "../components/ImageComp.astro";
import CountUpComponent from "~/components/CountUpComponent.jsx";
import FAQs from "../components/FAQs.astro";

const BOOK_FORM_WEBHOOK_URL = import.meta.env.BOOK_FORM_WEBHOOK_URL;
const PORTAL_API_KEY = import.meta.env.PORTAL_API_KEY;

const data = {
  siteTitle: "Why Become a Pilot at Ideal Aviation? | Ideal Aviation",
  siteDescription:
    "Ideal Aviation is the place for pilots in St. Louis, Missouri. We maintain the highest standards of safety in all of our operations. Our certified flight instructors have decades of combined experience, ensuring that you have the knowledge and skills you need to fly safely and confidently.",
};
---

<BaseLayout siteTitle={data.siteTitle} siteDescription={data.siteDescription}>
  <section class="mt-24 mx-auto max-w-2xl lg:max-w-7xl">
    <div
      class="absolute inset-0 h-[27vh] bg-gradient-to-bl from-0% via-30% from-main-blue via-transparent"
    >
    </div>

    <div class="max-w-xl lg:max-w-7xl mx-auto px-5 py-24 flex flex-col">
      <header class="flex gap-6 flex-col">
        <h1
          class="text-pretty text-4xl font-semibold tracking-tight text-main-black sm:text-6xl"
        >
          Why Become a Pilot at Ideal Aviation?
        </h1>
        <h2 class="text-gray-500 font-medium text-2xl max-w-3xl">
          We are a team of aviators that are experts in the flight training
          industry. We have decades of combined experience to get you safely in
          the air.
        </h2>
      </header>
      <div class="mt-16 grid grid-cols-1 lg:grid-cols-2 lg:gap-12">
        <div class="max-w-lg">
          <h2 class="text-2xl font-medium tracking-tight">Our mission</h2>
          <p class="mt-6 text-sm/6 text-gray-600">
            At Ideal Aviation, we are dedicated to delivering top-tier aviation
            training to our students. Our mission is to provide an exceptional
            learning experience, combining highly skilled instructors,
            cutting-edge facilities, and advanced training aircraft to prepare
            you for a successful career in aviation. We believe in fostering a
            learning environment that builds confidence and skill in every
            student.
          </p>
          <p class="mt-8 text-sm/6 text-gray-600">
            Our focus on safety, precision, and excellence sets us apart. We are
            committed to meeting the highest standards in aviation education,
            ensuring that every graduate leaves with the knowledge, skills, and
            dedication needed to excel in the industry. At Ideal Aviation,
            you’re not just a student; you’re part of a community that values
            your growth, achievement, and lifelong journey in aviation.
          </p>
        </div>
        <div class="pt-20 lg:row-span-2 lg:-mr-16 xl:mr-auto">
          <div
            class="-mx-8 grid grid-cols-2 gap-4 sm:-mx-16 sm:grid-cols-4 lg:mx-0 lg:grid-cols-2 lg:gap-4 xl:gap-8"
          >
            <div
              class="aspect-square overflow-hidden rounded-xl shadow-xl outline-1 -outline-offset-1 outline-black/10"
            >
              <ImageComp
                styles="block size-full object-cover"
                imagePath="/src/assets/images/group_ground.webp"
                imageAlt="Group of students on ground school"
              />
            </div>
            <div
              class="-mt-8 aspect-square overflow-hidden rounded-xl shadow-xl outline-1 -outline-offset-1 outline-black/10 lg:-mt-32"
            >
              <ImageComp
                styles="block size-full object-cover"
                imagePath="/src/assets/images/multi-engine-flying-cross-country.webp"
                imageAlt="Multi-engine flying cross country"
              />
            </div>
            <div
              class="aspect-square overflow-hidden rounded-xl shadow-xl outline-1 -outline-offset-1 outline-black/10"
            >
              <ImageComp
                styles="block size-full object-cover"
                imagePath="/src/assets/images/commercial-checkride-pass-helicopter.webp"
                imageAlt="Commercial Checkride Pass Helicopter"
              />
            </div>
            <div
              class="-mt-8 aspect-square overflow-hidden rounded-xl shadow-xl outline-1 -outline-offset-1 outline-black/10 lg:-mt-32"
            >
              <ImageComp
                styles="block size-full object-cover"
                imagePath="/src/assets/images/group-flight-ifr.webp"
                imageAlt="Group Flight IFR"
              />
            </div>
          </div>
        </div>
        <div class="max-lg:mt-16 lg:col-span-1">
          <h4>The Numbers</h4>
          <hr class="mt-6 border-t border-gray-200" />
          <dl class="mt-6 grid grid-cols-1 gap-x-8 gap-y-4 sm:grid-cols-2">
            <div
              class="flex flex-col gap-y-2 border-b border-dotted border-gray-200 pb-4"
            >
              <dt class="text-sm/6 text-gray-600">
                Airplanes, Helicopters, Simulators
              </dt>
              <dd class="order-first text-6xl font-medium tracking-tight">
                <CountUpComponent client:only="react" value={10} />+
              </dd>
            </div>
            <div
              class="flex flex-col gap-y-2 border-b border-dotted border-gray-200 pb-4"
            >
              <dt class="text-sm/6 text-gray-600">Graduates</dt>
              <dd class="order-first text-6xl font-medium tracking-tight">
                <CountUpComponent client:only="react" value={1000} />+
              </dd>
            </div>
            <div
              class="flex flex-col gap-y-2 max-sm:border-b max-sm:border-dotted max-sm:border-gray-200 max-sm:pb-4"
            >
              <dt class="text-sm/6 text-gray-600">Checkride Pass Rate</dt>
              <dd class="order-first text-6xl font-medium tracking-tight">
                <CountUpComponent client:only="react" value={98} />%
              </dd>
            </div>
            <div class="flex flex-col gap-y-2">
              <dt class="text-sm/6 text-gray-600">Happy Students</dt>
              <dd class="order-first text-6xl font-medium tracking-tight">
                <CountUpComponent client:only="react" value={100} />%
              </dd>
            </div>
          </dl>
        </div>
      </div>
    </div>
  </section>

  <section
    class="mx-2 mb-24 rounded-3xl bg-main-blue py-10 lg:py-16 px-5 text-white"
  >
    <div
      class="max-w-7xl mx-auto flex lg:flex-row flex-col items-center gap-10"
    >
      <ImageComp
        styles="block w-full max-w-xl lg:max-w-auto flex-1"
        imagePath="/src/assets/images/book-mockup.webp"
        imageAlt="Ideal Aviation Quick Start Guide"
        quality="100"
      />
      <div class="flex flex-col gap-5 justify-center flex-1">
        <h2
          class="text-xs/5 font-semibold text-gray-200 uppercase tracking-widest"
        >
          Still looking for more information on pilot training?
        </h2>
        <h3
          class="max-w-lg text-pretty text-4xl font-semibold tracking-tight text-gray-100 sm:text-5xl"
        >
          Get Your <span class="text-white">FREE</span> Pilot Training Guide Book!
        </h3>
        <p>
          We've prepared this free booklet which explains everything you need to
          know for your pilot certificate.
        </p>
        <form id="form">
          <input
            type="email"
            name="email"
            placeholder="Enter your email"
            class="w-full px-4 py-2 rounded-md text-main-black"
            required
          />
          <input
            type="email"
            name="confirm-email"
            placeholder="Confirm email"
            class="hidden"
          />
          <button type="submit" class="btn-secondary mt-4">
            Get Your Free Guide
          </button>
        </form>
      </div>
    </div>
  </section>

  <section
    class="mx-auto my-12 max-w-7xl px-6 sm:mt-20 sm:mb-48 lg:px-8"
    id="programs"
  >
    <div class="mx-auto max-w-3xl lg:mx-0">
      <h2
        class="text-pretty text-4xl font-semibold tracking-tight text-gray-900 sm:text-5xl"
      >
        Our training programs
      </h2>
      <p class="mt-6 text-lg/8 text-gray-600">
        Ideal Aviation offers <strong>Part 141</strong> and <strong
          >Part 61</strong
        > pilot training for rotary wing and fixed wing aircraft. From private pilot
        all the way to commercial and CFII MEI, Ideal Aviation is here to help you
        reach your goals.
      </p>
    </div>
    <dl
      class="mx-auto mt-16 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 text-base/7 sm:grid-cols-2 lg:mx-0 lg:max-w-none lg:grid-cols-3"
    >
      <div>
        <dt class="font-semibold text-gray-900">Private Pilot Certificate</dt>
        <dd class="mt-1 text-gray-600">
          Begin your journey with a Private Pilot Certificate, allowing you to
          fly for personal enjoyment. Our instructors will teach you essential
          skills like takeoff, landing, and safe navigation.
        </dd>
        <a href="/programs/private-pilot" class="btn-primary mt-5">Explore</a>
      </div>
      <div>
        <dt class="font-semibold text-gray-900">Instrument Rating</dt>
        <dd class="mt-1 text-gray-600">
          Gain the ability to fly confidently in low visibility by relying on
          instruments alone. This rating enhances safety and proficiency in
          diverse weather conditions.
        </dd>
        <a href="/programs/instrument-rating" class="btn-primary mt-5"
          >Explore</a
        >
      </div>
      <div>
        <dt class="font-semibold text-gray-900">
          Commercial Pilot Certificate
        </dt>
        <dd class="mt-1 text-gray-600">
          Fly for compensation with a Commercial Certificate. Our instructors
          guide you through advanced maneuvers, preparing you for the demands of
          commercial aviation.
        </dd>
        <a href="/programs/commercial-pilot" class="btn-primary mt-5">Explore</a
        >
      </div>
      <div>
        <dt class="font-semibold text-gray-900">Multi-Engine</dt>
        <dd class="mt-1 text-gray-600">
          Learn to operate multi-engine aircraft, mastering complex systems and
          emergency protocols for added safety and flexibility in advanced
          flight.
        </dd>
        <a href="/programs/multi-engine-rating" class="btn-primary mt-5"
          >Explore</a
        >
      </div>
      <div>
        <dt class="font-semibold text-gray-900">
          Certified Flight Instructor (CFI)
        </dt>
        <dd class="mt-1 text-gray-600">
          Share your passion. Our CFI program prepares you to confidently teach
          students, covering everything from basics to advanced ratings.
        </dd>
        <a href="/programs/cfi" class="btn-primary mt-5">Explore</a>
      </div>
      <div>
        <dt class="font-semibold text-gray-900">Helicopter Pilot Training</dt>
        <dd class="mt-1 text-gray-600">
          Take to the skies in a helicopter with our specialized training
          program. Learn the unique skills needed to operate rotary-wing
          aircraft.
        </dd>
        <a href="/programs/helicopter-pilot-training" class="btn-primary mt-5"
          >Explore</a
        >
      </div>
    </dl>
  </section>

  <section
    class="mx-2 mt-24 rounded-3xl bg-main-blue py-10 lg:pt-36 lg:pb-28 px-5"
  >
    <div class="max-w-7xl mx-auto rounded-3xl overflow-hidden lg:-mt-60">
      <iframe
        class="w-full aspect-video"
        src="https://tube.rvere.com/embed?v=NvrngKl0Vds&rel=0"
        title="Interview with Jim and Mary"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
      >
      </iframe>
    </div>
  </section>

  <FAQs />

  <script define:vars={{ BOOK_FORM_WEBHOOK_URL, PORTAL_API_KEY }}>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("form");
      if (!form) {
        console.error("Form element not found.");
        return;
      }

      form.addEventListener("submit", async (event) => {
        event.preventDefault();

        const formData = new FormData(form);
        const confirmEmail = formData.get("confirm-email")?.trim();

        if (confirmEmail) return;

        const webhookURL = BOOK_FORM_WEBHOOK_URL;
        const apiKey = PORTAL_API_KEY;

        const urlEncodedBody = new URLSearchParams(formData).toString();

        const jsonBody = {
          first_name: formData.get("first-name")?.trim() || "",
          last_name: formData.get("last-name")?.trim() || "",
          email: formData.get("email")?.trim() || "",
          phone: formData.get("phone")?.trim() || "",
          campaign: "training_book",
          account_random_id: "ac_kikjlgpq",
        };

        try {
          const [ghlRes, portalRes] = await Promise.all([
            fetch(webhookURL, {
              method: "POST",
              headers: {
                "Content-Type": "application/x-www-form-urlencoded",
              },
              body: urlEncodedBody,
            }),
            fetch("https://portal.rightruddermarketing.com/api/leads", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
                "x-api-key": apiKey,
              },
              body: JSON.stringify(jsonBody),
            }),
          ]);

          if (ghlRes.ok && portalRes.ok) {
            window.location.href = "/contact-confirmation";
          } else {
            console.error("Submission failed", {
              ghlStatus: ghlRes.status,
              portalStatus: portalRes.status,
            });
          }
        } catch (err) {
          console.error("Submission error:", err);
        }
      });
    });
  </script>
</BaseLayout>
